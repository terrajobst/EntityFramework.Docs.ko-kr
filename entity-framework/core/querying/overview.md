---
title: 쿼리 작동 방식 - EF Core
author: rowanmiller
ms.author: divega
ms.date: 10/27/2016
ms.assetid: de2e34cd-659b-4cab-b5ed-7a979c6bf120
ms.technology: entity-framework-core
uid: core/querying/overview
ms.openlocfilehash: 1d28d215302625cf2b6788359527a93a77b7e9fd
ms.sourcegitcommit: bdd06c9a591ba5e6d6a3ec046c80de98f598f3f3
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/10/2018
ms.locfileid: "42447721"
---
# <a name="how-queries-work"></a>쿼리 작동 방식

Entity Framework Core는 LINQ(Language-Integrated Query)를 사용하여 데이터베이스에서 데이터를 쿼리합니다. LINQ를 사용하면 C#(원하는 .NET 언어)을 사용하여 파생된 컨텍스트 및 엔터티 클래스를 기반으로 강력한 형식의 쿼리를 작성할 수 있습니다. 

## <a name="the-life-of-a-query"></a>쿼리의 수명

다음은 각 쿼리가 진행되는 프로세스에 대란 간략한 개요입니다.

1. LINQ 쿼리는 Entity Framework Core에서 처리되어 데이터베이스 공급자가 처리할 수 있는 표현을 작성합니다.
   1. 쿼리가 실행될 때마다 이 처리를 수행할 필요가 없도록 결과가 캐시됩니다.
2. 결과가 데이터베이스 공급자에 전달됩니다.
   1. 데이터베이스 공급자가 데이터베이스에서 평가할 수 있는 쿼리 부분을 식별합니다.
   2. 이러한 쿼리 부분이 데이터베이스별 쿼리 언어(예: 관계형 데이터베이스의 경우 SQL)로 변환됩니다.
   3. 하나 이상의 쿼리가 데이터베이스로 전송되고 결과 집합이 반환됩니다. 결과는 엔터티 인스턴스가 아닌 데이터베이스의 값입니다.
3. 결과 집합의 각 항목에 대해 다음을 수행합니다.
   1. 추적 쿼리인 경우 EF는 데이터가 컨텍스트 인스턴스에 대한 변경 추적 장치에 이미 있는 엔터티를 나타내는지 확인합니다.
      * 그럴 경우 기존 엔터티가 반환됩니다.
      * 그렇지 않을 경우 새 엔터티가 만들어지고 변경 내용 추적이 설정되며 새 엔터티가 반환됩니다.
   2. 비 추적 쿼리인 경우 EF는 데이터가 이 쿼리의 결과 집합에 이미 있는 엔터티를 나타내는지 확인합니다.
      * 그럴 경우 기존 엔터티가 반환됩니다.<sup>(1)</sup>
      * 그렇지 않을 경우 새 엔터티가 만들어지고 반환됩니다.

<sup>(1)</sup> 추적 쿼리는 약한 참조를 사용하여 이미 반환된 엔터티를 추적하지 않습니다. ID가 동일한 이전 결과가 범위를 벗어나고 가비지 수집이 실행되는 경우 새 엔터티 인스턴스를 가져올 수 있습니다.

## <a name="when-queries-are-executed"></a>쿼리가 실행되는 경우

LINQ 연산자를 호출할 때는 쿼리의 메모리 내 표현을 작성하기만 하면 됩니다. 쿼리는 결과가 사용될 때만 데이터베이스로 전송됩니다.

쿼리를 데이터베이스로 전송하는 가장 일반적인 작업은 다음과 같습니다.
* `for` 루프에서 결과 반복
* `ToList`, `ToArray`, `Single`, `Count` 같은 연산자 사용
* 쿼리 결과를 UI에 데이터 바인딩

> [!WARNING]  
> **항상 사용자 입력의 유효성 검사:** EF는 SQL 삽입 공격으로부터 보호를 제공하지만 입력의 일반적인 유효성 검사는 수행하지 않습니다. 따라서 값이 API에 전달되거나, LINQ 쿼리에서 사용되거나, 엔터티 속성에 할당되는 경우 신뢰할 수 없는 소스에서 가져오면 응용 프로그램 요구 사항에 따라 적절한 유효성 검사를 수행해야 합니다. 여기에는 쿼리를 동적으로 생성하는 데 사용되는 사용자 입력이 포함됩니다. LINQ를 사용하는 경우에도 식을 작성하는 사용자 입력을 허용하려면 의도한 식만 생성되도록 해야 합니다.
